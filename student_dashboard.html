<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Dashboard | CMCS VLS</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #050505; color: white; margin: 0; padding: 0; }
        .logo-watermark { position: fixed; inset: 0; z-index: -1; display: flex; justify-content: center; align-items: center; opacity: 0.04; pointer-events: none; }
        .logo-watermark img { height: 75%; filter: grayscale(1) brightness(0.5); }
        
        /* Preserved Original Border Radius */
        .glass-card { background: rgba(255, 255, 255, 0.03); backdrop-filter: blur(24px); -webkit-backdrop-filter: blur(24px); border: 1px solid rgba(255, 255, 255, 0.08); border-radius: 1.5rem; }
        
        .sidebar { background: rgba(0, 0, 0, 0.3); backdrop-filter: blur(20px); border-right: 1px solid rgba(255, 255, 255, 0.05); }
        .sidebar-btn, .subj-btn { transition: all 0.3s ease; color: #94a3b8; border: 1px solid transparent; }
        .sidebar-btn:hover, .subj-btn:hover { background: rgba(255, 255, 255, 0.05); color: white; }
        .active-nav { background: white !important; color: black !important; font-weight: 800; border-radius: 12px !important; }
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        input { background: rgba(255, 255, 255, 0.05) !important; border: 1px solid rgba(255, 255, 255, 0.1) !important; color: white !important; outline: none !important; }

        /* Mobile Tightening & Horizontal Scroll */
        .table-container { width: 100%; overflow-x: auto; -webkit-overflow-scrolling: touch; }
        table { min-width: 600px; width: 100%; }

        @media (max-width: 768px) {
            #workspace { padding: 0.75rem !important; }
            .main-content-area { padding: 0.5rem !important; }
            .glass-card { padding: 0.75rem !important; }
            th, td { padding: 0.75rem 0.5rem !important; }
            header { padding: 0.75rem 1rem !important; }
            .grid { gap: 0.5rem !important; }
            table { min-width: 500px; }
        }

        /* Fixed Print Output Layout */
        @media print {
            @page { margin: 1cm; }
            body { background: white !important; color: black !important; }
            body * { visibility: hidden; }
            #printArea, #printArea * { visibility: visible; }
            #printArea { position: absolute; left: 0; top: 0; width: 100%; background: white !important; }
            .no-print, .logo-watermark { display: none !important; }
            #tableBody td, #tableBody span, #tableBody div { color: black !important; opacity: 1 !important; }
            .glass-card { border: none !important; background: transparent !important; border-radius: 0 !important; overflow: visible !important; padding: 0 !important; }
            table { width: 100% !important; border-collapse: collapse !important; border: 1.5pt solid black !important; min-width: 100% !important; }
            th, td { border: 1pt solid black !important; padding: 10px !important; color: black !important; font-size: 9pt !important; }
            thead { background-color: #f2f2f2 !important; -webkit-print-color-adjust: exact; }
            .print-watermark { display: flex !important; position: fixed; inset: 0; justify-content: center; align-items: center; opacity: 0.05 !important; z-index: -1; }
            .print-watermark img { width: 400px; filter: grayscale(1); }
        }
    </style>
</head>
<body class="h-screen flex flex-col md:flex-row overflow-hidden">

    <div class="logo-watermark no-print"><img src="https://sklepagatesting.github.io/resources/Images/CMCSlogo.png"></div>

    <div class="md:hidden sidebar p-4 flex justify-between items-center z-[70] no-print h-16">
        <div class="font-black text-sm tracking-tighter uppercase">CMCS <span class="text-gray-500">VLS</span></div>
        <button onclick="toggleMobileMenu()" class="text-white p-2"><i class="fa-solid fa-bars-staggered"></i></button>
    </div>

    <aside id="sidebar" class="fixed inset-y-0 left-0 z-[90] w-72 sidebar transform -translate-x-full md:translate-x-0 transition-transform duration-300 ease-in-out flex flex-col no-print md:relative">
        <div class="h-20 hidden md:flex items-center px-8 border-b border-white/5">
            <div class="flex items-center gap-3">
                <img src="https://sklepagatesting.github.io/resources/Images/CMCSlogo.png" class="h-8 brightness-125">
                <span class="font-black text-lg tracking-tighter uppercase">CMCS <span class="text-gray-500">VLS</span></span>
            </div>
        </div>

        <nav class="flex-1 py-8 px-4 space-y-6 overflow-y-auto scrollbar-hide">
            <div>
                <p class="px-4 text-[10px] font-bold text-gray-500 uppercase tracking-[0.3em] mb-4">Core Portal</p>
                <a onclick="switchGlobalView('schedules'); closeMobileMenu();" id="navSched" class="sidebar-btn flex items-center gap-4 px-4 py-3.5 rounded-2xl text-sm font-semibold mb-2 cursor-pointer">
                    <i class="fa-solid fa-calendar-day text-xs"></i> <span class="uppercase">Schedules</span>
                </a>
                <a onclick="switchGlobalView('grades'); closeMobileMenu();" id="navGrades" class="sidebar-btn flex items-center gap-4 px-4 py-3.5 rounded-2xl text-sm font-semibold mb-2 cursor-pointer">
                    <i class="fa-solid fa-file-invoice text-xs"></i> <span class="uppercase">Records</span>
                </a>
            </div>
            <div>
                <p class="px-4 text-[10px] font-bold text-gray-500 uppercase tracking-[0.3em] mb-4">Enrolled Subjects</p>
                <div id="subjectNavItems" class="space-y-2"></div>
            </div>
        </nav>

        <div class="p-6 border-t border-white/5">
            <a href="student_edit.html" class="glass-card p-4 flex items-center gap-3 mb-4 block">
                <div id="adminInitial" class="w-10 h-10 rounded-full bg-white flex items-center justify-center text-xs font-bold text-black uppercase"></div>
                <div class="flex-1 min-w-0">
                    <p class="text-xs font-bold truncate uppercase text-white" id="adminName">...</p>
                    <p class="text-[9px] text-gray-500 font-bold uppercase tracking-widest" id="studentIdDisplay">ID: ---</p>
                </div>
            </a>
            <button onclick="logout()" class="w-full py-3 rounded-xl bg-red-500/10 text-red-500 text-[10px] font-black uppercase tracking-[0.2em]">Logout</button>
        </div>
    </aside>

    <div id="sidebarOverlay" onclick="toggleMobileMenu()" class="fixed inset-0 bg-black/80 backdrop-blur-sm z-[80] hidden md:hidden"></div>

    <main class="flex-1 flex flex-col h-full overflow-hidden">
        <header class="h-auto py-4 md:py-6 flex flex-col md:flex-row items-start md:items-center justify-between px-4 md:px-10 border-b border-white/5 no-print gap-4">
            <div class="flex flex-col">
                <h1 id="headerTitle" class="text-[11px] md:text-sm font-black uppercase tracking-widest text-white leading-none">DASHBOARD</h1>
                <div id="headerContext" class="flex flex-wrap items-center gap-2 mt-2"></div>
            </div>
            
            <div class="flex items-center gap-3 w-full md:w-auto">
                <div id="subjectToggles" class="hidden glass-card !rounded-xl p-1 flex flex-1 md:flex-none">
                    <button id="btnAtt" onclick="switchSubTab('attendance')" class="flex-1 md:flex-none px-4 py-2 text-[9px] font-black uppercase rounded-lg active-nav">Attendance</button>
                    <button id="btnMat" onclick="switchSubTab('materials')" class="flex-1 md:flex-none px-4 py-2 text-[9px] font-black uppercase rounded-lg text-gray-400">Materials</button>
                </div>
                <div id="exportGroup" class="flex gap-2">
                    <button onclick="exportCSV()" class="px-3 py-2 bg-white/5 border border-white/10 rounded-xl text-[9px] font-black uppercase">CSV</button>
                    <button onclick="exportPDF()" class="px-3 py-2 bg-red-500/10 border border-red-500/20 text-red-500 rounded-xl text-[9px] font-black uppercase">PDF</button>
                </div>
            </div>
        </header>

        <div class="flex-1 overflow-y-auto p-4 md:p-10 scrollbar-hide main-content-area">
            <div id="workspace" class="space-y-4 md:space-y-8">
                <div class="grid grid-cols-2 md:grid-cols-4 gap-3 no-print" id="infoSummary"></div>

                <div id="printArea">
                    <div class="print-watermark hidden"><img src="https://sklepagatesting.github.io/resources/Images/CMCSlogo.png"></div>
                    <div id="printHeader" class="hidden flex-col items-center text-center w-full mb-8">
                        <img src="https://sklepagatesting.github.io/resources/Images/CMCSlogo.png" class="w-16 mb-2">
                        <h2 class="text-xl font-black text-black">CENTRAL MINDANAO COMPUTER SCHOOL</h2>
                        <p class="text-[9px] text-black uppercase font-bold">Poblacion, Tulunan, Cotabato</p>
                        <p class="w-full border-t-2 border-black mt-4 pt-2 font-black text-black uppercase tracking-widest text-sm" id="lblReportType"></p>
                        <div class="grid grid-cols-2 gap-x-12 mt-6 text-left w-full border-b border-black pb-4 text-black text-[10pt]">
                            <div class="space-y-1">
                                <p class="font-bold">Student: <span id="pName" class="font-normal uppercase"></span></p>
                                <p class="font-bold">ID Number: <span id="pID" class="font-normal"></span></p>
                                <p class="font-bold">Course: <span id="pCourse" class="font-normal uppercase"></span></p>
                            </div>
                            <div class="space-y-1">
                                <p class="font-bold">Year/Sem: <span id="pYearSem" class="font-normal uppercase"></span></p>
                                <p class="font-bold">School Year: <span class="font-normal">2025-2026</span></p>
                                <p class="font-bold italic">Date Generated: <span id="pGenDate" class="font-normal not-italic"></span></p>
                            </div>
                        </div>
                    </div>

                    <div class="glass-card overflow-hidden">
                        <div class="table-container scrollbar-hide">
                            <table class="w-full text-left border-collapse">
                                <thead id="tableHead" class="bg-white/5 text-[9px] uppercase font-black text-gray-400"></thead>
                                <tbody id="tableBody" class="divide-y divide-white/5 text-xs"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
